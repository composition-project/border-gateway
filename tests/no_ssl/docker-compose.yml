version: '3.5'
services:

  tester:
    image: "tester:latest"
    networks:
      - public
    links:
      - "bgw:bgw.test.eu"
    volumes:
    - "../..:/bgw"
    entrypoint:
      - /bgw/tests/test.sh
      - /bgw/certs/CA.pem
      - no_ssl

  bgw:
    image: "docker.linksmart.eu/bgw:snapshot"
    ports:
    - 9227:9227
    - 9228:9228
    - 9229:9229
    - 9230:9230
    - 9231:9231
    networks:
      - backend_backend
      - public
    command: ["parts","bgw-http-proxy","bgw-mqtt-proxy","bgw-websocket-proxy","bgw-auth-service"]
    volumes:
    - "./volumes/bgw/config:/bgw/config"

networks:
  public:
    driver: bridge
  backend_backend:
    external: true
