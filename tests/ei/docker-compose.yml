version: '3.5'
services:

  tester:
    image: "tester:latest"
    networks:
      - public
    links:
      - "bgw:bgw.test.eu"
    volumes:
    - "../..:/bgw"
    entrypoint:
      - /bgw/tests/test.sh
      - /bgw/certs/CA.pem
      - ei

  bgw:
    image: "docker.linksmart.eu/bgw:snapshot"
    ulimits:
      nofile:
        soft: 50
        hard: 50
    ports:
      - 9227:9227
      - 9228:9228
      - 9229:9229
      - 9230:9230
      - 9231:9231
    networks:
      - backend_backend
      - public
    volumes:
      - "./volumes/bgw/config:/bgw/config"
      - "../../certs:/bgw/certs"

networks:
  public:
    driver: bridge
  backend_backend:
    external: true
